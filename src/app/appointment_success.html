<!DOCTYPE html>
<html>
<head>
    <title>Appointment Scheduled</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <h2>Appointment Scheduled Successfully</h2>
    <div id="appointmentDetails"></div>

    <script>
        window.onload = async function () {
            const data = JSON.parse(sessionStorage.getItem("appointmentDetails"));
            if (!data) {
                document.getElementById("appointmentDetails").innerText = "No appointment data found.";
                return;
            }

            // Fetch doctor and patient names from their IDs
            const [doctorRes, patientRes] = await Promise.all([
                fetch(`/api/Doctors/${data.doctorId}`),
                fetch(`/api/Patients/${data.patientId}`)
            ]);

            const doctor = await doctorRes.json();
            const patient = await patientRes.json();

            document.getElementById("appointmentDetails").innerHTML = `
                <p><strong>Doctor:</strong> ${doctor.name}</p>
                <p><strong>Patient:</strong> ${patient.name}</p>
                <p><strong>Start Time:</strong> ${new Date(data.startTime).toLocaleString()}</p>
                <p><strong>End Time:</strong> ${new Date(data.endTime).toLocaleString()}</p>
                <p><strong>Duration:</strong> ${data.durationInMinutes} minutes</p>
                <p><strong>Notes:</strong> ${data.notes || 'None'}</p>
            `;
        };
    </script>
</body>
</html>
